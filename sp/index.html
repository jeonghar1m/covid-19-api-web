<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>코로나19 감염자 현황</title>
    <link rel="stylesheet" type="text/css" href="style.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.3/jquery.min.js"></script>
    <!-- <script src="covid-api.js"></script> -->
</head>
<body>
    <header>
        <span id="title_name"><h1>코로나19 현황 조회하기</h1></span>
    </header>
    <section>
        <fieldset>
            <legend>도시 선택</legend>
            <table>
                <tr>
                    <td>
                        <input type="button" value="합계" onclick="ajax(0);" />
                        <input type="button" value="서울" onclick="ajax(1);" />
                        <input type="button" value="제주" onclick="ajax(2);" />
                        <input type="button" value="경남" onclick="ajax(3);" />
                        <input type="button" value="경북" onclick="ajax(4);" />
                        <input type="button" value="전남" onclick="ajax(5);" />
                        <input type="button" value="전북" onclick="ajax(6);" />
                        <input type="button" value="충남" onclick="ajax(7);" />
                        <input type="button" value="충북" onclick="ajax(8);" />
                        <input type="button" value="강원" onclick="ajax(9);" />
                        <input type="button" value="경기" onclick="ajax(10);" />
                        <input type="button" value="세종" onclick="ajax(11);" />
                        <input type="button" value="울산" onclick="ajax(12);" />
                        <input type="button" value="대전" onclick="ajax(13);" />
                        <input type="button" value="광주" onclick="ajax(14);" />
                        <input type="button" value="인천" onclick="ajax(15);" />
                        <input type="button" value="대구" onclick="ajax(16);" />
                        <input type="button" value="부산" onclick="ajax(17);" />
                    </td>
                </tr>
            </table>
        </fieldset>
        <p id="decide"></p>
        <p id="clear"></p>
        <p id="death"></p>
        <p id="care"></p>
    </section>
    <script>
        var button = document.querySelectorAll('input');
        var decide = document.querySelector('#decide');
        var clear = $('#clear');
        var death = $('#death');
        var care = $('#care');

        function ajax(buttonIndex) {
            var dataIndex = 0;
            console.log(button[buttonIndex].value);

            if(buttonIndex == 0)   dataIndex = 18; // 합계
            else if(buttonIndex == 1)  dataIndex = 17; // 서울
            else dataIndex = buttonIndex - 1;

            fetch('result.php')
            .then( (response) => {
                return response.json();
            })
            .then ( (data) => {
                decide.innerText = "누적 확진자: " + data.object.body.items.item[dataIndex].defCnt;
            });
        }
    </script>
</body>
</html>